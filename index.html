<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SkyCast ‚Äì Weather Intelligence</title>

<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/icons/favicon-32.png">

<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
<script src="https://unpkg.com/lucide@latest"></script>

<!-- Google AdSense -->
<script async
  src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXX"
  crossorigin="anonymous"></script>

<style>
/* ================= BASE ================= */
body{
  font-family: Inter, system-ui;
  color:#fff;
  min-height:100vh;
  overflow-x:hidden;
  transition:background 1s ease;
}

/* ================= WEATHER BACKGROUNDS ================= */
.bg-day{
  background:radial-gradient(circle at top,#7dd3fc,#0ea5e9,#020617);
}
.bg-night{
  background:radial-gradient(circle at top,#1e293b,#020617);
}
.bg-rain{
  background:linear-gradient(#0f172a,#020617);
}
.bg-storm{
  background:radial-gradient(circle at top,#312e81,#020617);
}
.bg-snow{
  background:linear-gradient(#e5f3ff,#64748b,#020617);
}

/* ================= CLOUD LAYER ================= */
.clouds::before{
  content:"";
  position:fixed;
  inset:0;
  background:url("https://www.transparenttextures.com/patterns/clouds.png");
  opacity:.25;
  animation:cloudMove 120s linear infinite;
  pointer-events:none;
}
@keyframes cloudMove{
  from{background-position:0 0}
  to{background-position:10000px 0}
}

/* ================= RAIN ================= */
.rain::after{
  content:"";
  position:fixed;
  inset:0;
  background:url("https://www.transparenttextures.com/patterns/stardust.png");
  animation:rainMove .4s linear infinite;
  opacity:.18;
}
@keyframes rainMove{
  from{background-position:0 0}
  to{background-position:0 1200px}
}

/* ================= SNOW ================= */
.snow::after{
  content:"";
  position:fixed;
  inset:0;
  background:url("https://www.transparenttextures.com/patterns/snow.png");
  animation:snowMove 12s linear infinite;
  opacity:.35;
}
@keyframes snowMove{
  from{background-position:0 0}
  to{background-position:600px 1200px}
}

/* ================= LIGHTNING ================= */
.flash{
  animation:flash 6s infinite;
}
@keyframes flash{
  0%,95%,100%{background-color:transparent}
  96%,98%{background-color:rgba(255,255,255,.25)}
}

/* ================= UI ================= */
.glass{
  background:rgba(255,255,255,.12);
  backdrop-filter:blur(14px);
  border-radius:1.5rem;
  border:1px solid rgba(255,255,255,.2);
}

/* ================= WIND COMPASS ================= */
.compass{
  width:70px;
  height:70px;
  border:2px solid rgba(255,255,255,.4);
  border-radius:50%;
  position:relative;
  margin:auto;
}
.compass::after{
  content:"N";
  position:absolute;
  top:-18px;
  left:50%;
  transform:translateX(-50%);
  font-size:.75rem;
  opacity:.7;
}
.arrow{
  width:2px;
  height:28px;
  background:#38bdf8;
  position:absolute;
  top:8px;
  left:50%;
  transform-origin:bottom center;
  transform:translateX(-50%) rotate(0deg);
}
</style>
</head>

<body class="bg-night clouds">

<div class="max-w-6xl mx-auto p-6 space-y-6">

<header class="flex justify-between items-center">
  <h1 class="text-2xl font-bold flex items-center gap-2">
    <i data-lucide="cloud-sun"></i> SkyCast
  </h1>
</header>

<!-- TOP WEBSITE AD -->
<div class="glass p-3 text-center">
  <ins class="adsbygoogle"
    style="display:block"
    data-ad-client="ca-pub-XXXXXXXXXXXX"
    data-ad-slot="1111111111"
    data-ad-format="auto"></ins>
</div>

<!-- HERO -->
<div class="glass p-8 grid md:grid-cols-2 gap-6">
  <div>
    <p id="city" class="text-lg opacity-80">Detecting location‚Ä¶</p>
    <p id="temp" class="text-7xl font-bold">--¬∞</p>
    <p id="desc" class="text-blue-200 text-lg"></p>
    <p id="time" class="text-sm opacity-60 mt-1"></p>
  </div>

  <div class="grid grid-cols-2 gap-4">
    <div class="glass p-4">üíß Humidity <p id="humidity" class="text-xl font-bold">--%</p></div>
    <div class="glass p-4">üå¨ Wind
      <div class="compass mt-2">
        <div id="windArrow" class="arrow"></div>
      </div>
      <p id="wind" class="text-sm mt-1"></p>
    </div>
    <div class="glass p-4">‚òÄ UV <p id="uv" class="text-xl font-bold">--</p></div>
    <div class="glass p-4">ü´Å PM2.5 <p id="aqi" class="text-xl font-bold">--</p></div>
  </div>
</div>

<!-- AI -->
<div class="glass p-6">
  <h3 class="font-semibold mb-2">AI Forecast</h3>
  <p id="ai">Generating‚Ä¶</p>
</div>

<!-- HOURLY -->
<div class="glass p-6">
  <h3 class="font-semibold mb-2">Hourly Forecast</h3>
  <div id="hourly" class="flex gap-3 overflow-x-auto"></div>
</div>

<!-- INLINE AD -->
<div class="glass p-4 text-center">
  <ins class="adsbygoogle"
    style="display:block"
    data-ad-client="ca-pub-XXXXXXXXXXXX"
    data-ad-slot="2222222222"
    data-ad-format="rectangle"></ins>
</div>

<!-- DAILY -->
<div class="glass p-6">
  <h3 class="font-semibold mb-2">7-Day Forecast</h3>
  <div id="daily" class="space-y-2"></div>
</div>

<footer class="text-center text-xs opacity-50 pt-8">
¬© 2025 SkyCast Weather Intelligence
</footer>

</div>

<script>
lucide.createIcons();
const $=id=>document.getElementById(id);

/* LOCATION */
navigator.geolocation.getCurrentPosition(
p=>loadWeather(p.coords.latitude,p.coords.longitude,"Your Location"),
()=>loadWeather(28.61,77.2,"New Delhi")
);

/* WEATHER */
async function loadWeather(lat,lon,city){
$("city").textContent=city;

const w=await fetch(
`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}
&current=temperature_2m,relative_humidity_2m,weather_code,is_day,wind_speed_10m,wind_direction_10m
&hourly=time,temperature_2m
&daily=time,temperature_2m_max,temperature_2m_min,uv_index_max
&timezone=auto`
).then(r=>r.json());

$("temp").textContent=Math.round(w.current.temperature_2m)+"¬∞";
$("desc").textContent(desc(w.current.weather_code));
$("humidity").textContent=w.current.relative_humidity_2m+"%";
$("wind").textContent=w.current.wind_speed_10m+" km/h";
$("uv").textContent=w.daily.uv_index_max[0];
$("time").textContent=new Date().toLocaleTimeString();

rotateCompass(w.current.wind_direction_10m);
setBackground(w.current.weather_code,w.current.is_day);

renderHourly(w);
renderDaily(w);
loadAir(lat,lon);
generateAI(city,w.current.temperature_2m,desc(w.current.weather_code));
}

/* AIR QUALITY */
async function loadAir(lat,lon){
const a=await fetch(
`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${lat}&longitude=${lon}&hourly=pm2_5`
).then(r=>r.json());
$("aqi").textContent=Math.round(a.hourly.pm2_5[0]);
}

/* UI */
function renderHourly(w){
hourly.innerHTML="";
for(let i=0;i<24;i++){
hourly.innerHTML+=`
<div class="glass p-3 min-w-[80px] text-center">
${new Date(w.hourly.time[i]).getHours()}:00<br>
<b>${Math.round(w.hourly.temperature_2m[i])}¬∞</b>
</div>`;
}}
function renderDaily(w){
daily.innerHTML="";
for(let i=0;i<7;i++){
daily.innerHTML+=`
<div class="glass p-3 flex justify-between">
${new Date(w.daily.time[i]).toLocaleDateString(undefined,{weekday:"short"})}
<span>${Math.round(w.daily.temperature_2m_max[i])}¬∞ / ${Math.round(w.daily.temperature_2m_min[i])}¬∞</span>
</div>`;
}}

/* BACKGROUND */
function setBackground(code,isDay){
document.body.className="";
if(code>=95)document.body.classList.add("bg-storm","rain","flash","clouds");
else if(code>=71)document.body.classList.add("bg-snow","snow","clouds");
else if(code>=61)document.body.classList.add("bg-rain","rain","clouds");
else if(isDay)document.body.classList.add("bg-day","clouds");
else document.body.classList.add("bg-night","clouds");
}

/* WIND COMPASS */
function rotateCompass(deg){
$("windArrow").style.transform=`translateX(-50%) rotate(${deg}deg)`;
}

/* HELPERS */
function desc(c){return{0:"Clear",1:"Partly Cloudy",2:"Cloudy",61:"Rain",71:"Snow",95:"Thunderstorm"}[c]||"Weather";}

/* AI */
async function generateAI(city,temp,code){
try{
const r=await fetch("/api/ai-forecast",{method:"POST",headers:{"Content-Type":"application/json"},
body:JSON.stringify({city,temp,code})});
const d=await r.json();
$("ai").textContent=d.text;
}catch{$("ai").textContent="AI unavailable";}
}

/* ADS */
(adsbygoogle=window.adsbygoogle||[]).push({});
(adsbygoogle=window.adsbygoogle||[]).push({});
</script>

</body>
</html>
